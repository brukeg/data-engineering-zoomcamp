# my-homework-4

## Setup

1. Understanding dbt model resolution

    **select * from dtc_zoomcamp_2025.raw_nyc_tripdata.ext_green_taxi**

2. dbt Variables & Dynamic Models

    **Update the WHERE clause to pickup_datetime >= CURRENT_DATE - INTERVAL '{{ var("days_back", env_var("DAYS_BACK", "30")) }}' DAY**

3. dbt Data Lineage and Execution

    **dbt run --select models/staging/+**

4. dbt Macros and Jinja

    **1,3,4,5**

5. Taxi Quarterly Revenue Growth: which were the yearly quarters with the best (or less worse) and worst results for green, and yellow
```sql
WITH best_worst_quarters AS (
    SELECT 
        service_type,
        year_quarter,
        yoy_growth,
        RANK() OVER (PARTITION BY service_type ORDER BY yoy_growth DESC) AS best_rank,
        RANK() OVER (PARTITION BY service_type ORDER BY yoy_growth ASC) AS worst_rank
    FROM `compact-arc-447521-f9.dbt_bgetachew.fact_trips_quarterly_revenue`
    WHERE year = 2020
),
best AS (
SELECT 
    service_type,
    year_quarter AS best_quarter,
    yoy_growth AS best_growth
FROM best_worst_quarters
WHERE best_rank = 1
),
worst AS (
SELECT 
    service_type,
    year_quarter AS worst_quarter,
    yoy_growth AS worst_growth
FROM best_worst_quarters
WHERE worst_rank = 1
)
SELECT *
FROM best JOIN worst USING (service_type);
```

**green: {best: 2020/Q1, worst: 2020/Q2}, yellow: {best: 2020/Q1, worst: 2020/Q2}**

6. 

7. 

8. 